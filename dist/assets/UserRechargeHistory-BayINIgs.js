import{A as w,u as D,r as l,a as Y,j as e,B as x,I as p,b as d}from"./index--FpPv6_1.js";import{h as i}from"./moment-C5S46NFB.js";const v=()=>{const b=D(),[n,h]=l.useState([]),[m,u]=l.useState({}),o=localStorage.getItem("token"),{id:c}=Y();l.useEffect(()=>{const r=async()=>{try{const f=(await d.get(`/api/history/admin-api/recharge-user-history/get-user-recharge-history?userId=${c}`,{headers:{Authorization:`Bearer ${o}`}})).data.sort((y,g)=>{const N=i(y.date_time,"DD/MM/YYYY hh:mm:ss A").toDate();return i(g.date_time,"DD/MM/YYYY hh:mm:ss A").toDate()-N});h(f)}catch{console.error("Failed to fetch history data")}},a=async()=>{try{const t=await d.get(`/api/user/user-admin-api/get-user?userId=${c}`,{headers:{Authorization:`Bearer ${o}`}});u(t.data)}catch{console.error("Failed to fetch user data")}};r(),a()},[c]);const j=async r=>{try{await d.delete(`/api/history/admin-api/recharge-history-delete/delete-recharge-history?id=${r}`,{headers:{Authorization:`Bearer ${o}`}}),h(a=>a.filter(t=>t.transaction_id!==r)),console.log("After delete:",n)}catch(a){console.error("Failed to delete recharge history:",a)}},s={wordBreak:"break-word",whiteSpace:"normal",overflowWrap:"break-word"};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full my-4 flex items-center justify-between",children:e.jsxs(x,{variant:"link",onClick:()=>b(`/users-data/${c}`),className:"text-sm font-normal text-[#8C8C8C] !no-underline p-1 h-0 flex gap-2",children:[e.jsx(p.arrowLeft,{className:"w-4 h-4"})," User Recharge History"]})}),e.jsx("div",{className:"flex items-center justify-center pt-[1rem]",children:e.jsxs("div",{className:"bg-transparent w-full max-w-md rounded-lg mb-[60px] border-none dark",children:[e.jsxs("div",{className:"bg-[#484848] text-sm py-3 px-5 flex mb-4 w-full items-center justify-between rounded-lg",children:[e.jsx("h3",{className:"font-medium pr-4 border-r",children:"Email"}),e.jsx("p",{className:"font-normal pl-4 text-[#9B9B9B]",style:s,children:m.email})]}),e.jsxs("div",{className:"w-full flex items-center justify-center gap-6 my-6",children:[e.jsx("p",{className:"text-[#959595]",children:"Balance:"}),e.jsx("span",{className:"text-white",children:m.balance})]}),n.length>0?n.map((r,a)=>e.jsx("div",{className:"mt-[1.5rem] w-full border-[10px] border-[#444444] rounded-lg",children:e.jsx("table",{className:"w-full table-auto",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"border-b-2 border-[#949494] p-3 px-5 text-[#959595]",children:"Transaction ID"}),e.jsx("td",{className:"border-b-2 border-[#949494] p-3 ",style:s,children:e.jsx("span",{children:r.transaction_id})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border-b-2 border-[#949494] p-3 px-5 text-[#959595]",children:"Amount"}),e.jsx("td",{className:"border-b-2 border-[#949494] p-3",style:s,children:r.amount})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border-b-2 border-[#949494] p-3 px-5 text-[#959595]",children:"Type"}),e.jsx("td",{className:"border-b-2 border-[#949494] p-3",style:s,children:r.payment_type})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border-b-2 border-[#949494] p-3 px-5 text-[#959595]",children:"Date & Time"}),e.jsx("td",{className:"border-b-2 border-[#949494] p-3",style:s,children:i(r.date_time,"DD/MM/YYYY hh:mm:ss A").format("DD/MM/YYYY hh:mm:ss A")})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border-b-2 border-[#949494]  px-5 text-[#959595]",children:"Status"}),e.jsx("td",{className:"border-b-2 border-[#949494] p-3   ",children:e.jsxs("td",{className:"justify-between	 items-center flex",style:s,children:[e.jsx("span",{children:r.status}),e.jsx(x,{onClick:t=>{t.stopPropagation(),j(r.transaction_id)},children:e.jsx(p.trash,{className:" w-4 h-4 text-red-600 "})})]})})]})]})})},r.transaction_id)):e.jsx("div",{className:"text-white text-center h-full flex items-center justify-center",children:"No history available"})]})})]})},M=w()(v);export{M as default};
