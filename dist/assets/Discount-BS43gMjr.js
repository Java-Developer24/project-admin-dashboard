import{A as T,u as L,r as n,j as e,B as z,I as R,b as d,_ as u}from"./index--FpPv6_1.js";import{S as h,a as x,b as p,c as j,d as g,e as b}from"./Select-DDdZlMlL.js";import{L as f}from"./index-ny5ticeX.js";import"./index-BzNKqasO.js";import"./index-DiOThvEn.js";const V=()=>{const t=L(),[a,S]=n.useState(""),[D,v]=n.useState(""),[N,y]=n.useState([]),l=localStorage.getItem("token"),[c,m]=n.useState({serverDiscounts:[],serviceDiscounts:[],userDiscounts:[]}),k=[{value:"server",label:"Server Discount"},{value:"service",label:"Service Discount"},{value:"user",label:"User Discount"}];n.useEffect(()=>{(async()=>{try{const I=(await d.get("/api/server/admin-api/server-data-get/get-server",{headers:{Authorization:`Bearer ${l}`}})).data.filter(i=>i.server!==0).map(i=>({value:i.server.toString(),label:`Server ${i.server}`}));y(I)}catch(r){o(r)}})()},[]);const w=s=>{S(s),v(""),s==="server"?C():s==="service"?$():s==="user"&&t("/discount/user")},C=async()=>{try{const s=await d.get("/api/server/admin-api/server-discount-update/get-server-discount",{headers:{Authorization:`Bearer ${l}`}});m(r=>({...r,serverDiscounts:s.data||[]}))}catch(s){o(s)}},$=async()=>{try{const s=await d.get("/api/service/admin-api/server-discount-data/get-all-service-discount",{headers:{Authorization:`Bearer ${l}`}});m(r=>({...r,serviceDiscounts:s.data||[]}))}catch(s){o(s)}},o=s=>{console.error("Error:",s),s.response?u.error(s.response.data.message||"Error fetching data"):s.request?u.error("No response received from the server"):u.error(`Error: ${s.message}`)},A=s=>{v(s),a==="server"?t(`/discount/server/${s}`):a==="service"&&t(`/discount/service/${s}`)},E=()=>e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Active Discounts"}),c.serverDiscounts.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-md font-medium mb-2",children:"Server Discounts"}),e.jsx("div",{className:"bg-[#282828] p-4 rounded-lg",children:c.serverDiscounts.map((s,r)=>e.jsxs("div",{className:"flex justify-between items-center mb-2 cursor-pointer hover:bg-[#333333] p-2 rounded",onClick:()=>t(`/discount/server/${s.server}`),children:[e.jsxs("span",{children:["Server ",s.server]}),e.jsxs("span",{children:["Rs ",s.discount,".00"]})]},r))})]}),c.serviceDiscounts.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-md font-medium mb-2",children:"Service Discounts"}),e.jsx("div",{className:"bg-[#282828] p-4 rounded-lg",children:c.serviceDiscounts.map((s,r)=>e.jsxs("div",{className:"flex justify-between items-center mb-2 cursor-pointer hover:bg-[#333333] p-2 rounded",onClick:()=>t(`/discount/service/${s.server}`),children:[e.jsx("span",{children:s.service}),e.jsxs("div",{children:[e.jsxs("span",{children:["Server ",s.server]}),e.jsxs("span",{className:"ml-4",children:["Rs ",s.discount,".00"]})]})]},r))})]}),c.userDiscounts.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-md font-medium mb-2",children:"User Discounts"}),e.jsx("div",{className:"bg-[#282828] p-4 rounded-lg",children:c.userDiscounts.map((s,r)=>e.jsx("div",{className:"flex justify-between items-center mb-2 cursor-pointer hover:bg-[#333333] p-2 rounded",onClick:()=>t(`/discount/user/${s.userId._id}`),children:e.jsx("span",{children:s.userId.email})},r))})]})]}),B=()=>t("/");return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full my-2",children:e.jsxs(z,{variant:"link",onClick:B,className:"text-sm font-normal text-[#8C8C8C] !no-underline p-1 h-0 flex gap-2",children:[e.jsx(R.arrowLeft,{className:"w-4 h-4"})," Discount"]})}),e.jsx("div",{className:"flex items-center justify-center pt-[1rem]",children:e.jsxs("div",{className:"bg-transparent w-full max-w-md rounded-lg mb-[60px] border-none dark",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(f,{className:"text-[#9d9d9d] mb-2",children:"Select Discount Type"}),e.jsxs(h,{value:a,onValueChange:w,children:[e.jsx(x,{className:"w-full dark bg-[#282828]",children:e.jsx(p,{placeholder:"Select discount type"})}),e.jsx(j,{className:"dark bg-[#1e1e1e]",children:e.jsx(g,{children:k.map(s=>e.jsx(b,{value:s.value,children:s.label},s.value))})})]})]}),a&&a!=="user"&&e.jsxs("div",{children:[e.jsx(f,{className:"text-[#9d9d9d] mb-2",children:"Select Server"}),e.jsxs(h,{value:D,onValueChange:A,children:[e.jsx(x,{className:"w-full dark bg-[#282828]",children:e.jsx(p,{placeholder:"Select server"})}),e.jsx(j,{className:"dark bg-[#1e1e1e]",children:e.jsx(g,{children:N.map(s=>e.jsx(b,{value:s.value,children:s.label},s.value))})})]})]})]}),E()]})})]})},H=T()(V);export{H as default};
